<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>More ANOVA designs • Superpower</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="More ANOVA designs">
<meta property="og:description" content="Superpower">
<meta property="og:image" content="/Sticker/Superpower2.PNG">
<meta property="og:image:alt" content="Superpower logo">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@exphysstudent">
<meta name="twitter:site" content="@exphysstudent">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Superpower</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ANCOVAs.html">Power Calculations for ANCOVA</a>
    </li>
    <li>
      <a href="../articles/compromise_power.html">Introduction to Justifying Alpha Levels</a>
    </li>
    <li>
      <a href="../articles/emmeans_power.html">Power calculations for `emmeans` analyses</a>
    </li>
    <li>
      <a href="../articles/intro_to_superpower.html">Introduction to Superpower</a>
    </li>
    <li>
      <a href="../articles/more_anova_designs.html">More ANOVA designs</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/arcaldwell49/Superpower/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>More ANOVA designs</h1>
                        <h4 data-toc-skip class="author">Aaron R.
Caldwell</h4>
            
            <h4 data-toc-skip class="date">2024-07-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/arcaldwell49/Superpower/blob/HEAD/vignettes/more_anova_designs.Rmd" class="external-link"><code>vignettes/more_anova_designs.Rmd</code></a></small>
      <div class="hidden name"><code>more_anova_designs.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://aaroncaldwell.us/SuperpowerBook/" class="external-link">Superpower</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/Superpower_options.html">Superpower_options</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span>,
                   plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">nsims</span> <span class="op">=</span> <span class="fl">250</span></code></pre></div>
<p>In this vignette we will quickly demonstrate a few variations on
ANOVA designs and how to implement them in <code>Superpower</code>. To
see even more designs, please check out our <a href="https://aaroncaldwell.us/SuperpowerBook/" class="external-link">book</a></p>
<div class="section level2">
<h2 id="three-between-subject-conditions">Three between subject conditions<a class="anchor" aria-label="anchor" href="#three-between-subject-conditions"></a>
</h2>
<p>Imagine we aim to design a study to test the hypothesis that giving
people a pet to take care of will increase their life satisfaction. We
have a control condition, a ‘cat’ pet condition, and a ‘dog’ pet
condition. We can simulate a One-Way ANOVA with a specified alpha,
sample size, and effect size, and see the statistical power we would
have for the ANOVA and the follow-up comparisons. We expect all pets to
increase life-satisfaction compared to the control condition. Obviously,
we also expect the people who are in the ‘dog’ pet condition to have
even greater life-satisfaction than people in the ‘cat’ pet condition.
Based on work by Pavot and Diener (1993) we again assume that we can
expect responses on the life-satisfaction scale to have a mean of
approximately 24 in our population, with a standard deviation of 6.4. We
expect having a pet increases life satisfaction with approximately 2.2
scale points for participants who get a cat, and 2.6 scale points for
participants who get a dog. We initially consider collecting data from
150 participants in total, with 50 participants in each condition. But
before we proceed with the data collection, we examine the statistical
power our design would have to detect the differences we predict.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span> <span class="op">&lt;-</span> <span class="st">"3b"</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">26.2</span>, <span class="fl">26.6</span><span class="op">)</span>
<span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">6.4</span>
<span class="va">label_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"cat"</span>, <span class="st">"dog"</span><span class="op">)</span><span class="op">)</span>

<span class="va">design_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ANOVA_design.html">ANOVA_design</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span>,
                   n <span class="op">=</span> <span class="va">n</span>, 
                   mu <span class="op">=</span> <span class="va">mu</span>, 
                   sd <span class="op">=</span> <span class="va">sd</span>, 
                   label_list <span class="op">=</span> <span class="va">label_list</span>,
                   plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="more_anova_designs_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<pre><code><span class="fu"><a href="../reference/ANOVA_exact.html">ANOVA_exact2</a></span><span class="op">(</span><span class="va">design_result</span>,
            emm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Pairwise emmeans will automatically run</span>
            
<span class="co">#&gt; Power and Effect sizes for ANOVA tests</span>
<span class="co">#&gt;             power partial_eta_squared cohen_f non_centrality</span>
<span class="co">#&gt; condition 47.5236              0.0314    0.18         4.7651</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for pairwise comparisons (t-tests)</span>
<span class="co">#&gt;                                   power effect_size</span>
<span class="co">#&gt; p_condition_control_condition_cat 39.83        0.34</span>
<span class="co">#&gt; p_condition_control_condition_dog 52.05        0.41</span>
<span class="co">#&gt; p_condition_cat_condition_dog      6.10        0.06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for estimated marginal means</span>
<span class="co">#&gt;                            contrast  power partial_eta_squared cohen_f</span>
<span class="co">#&gt; 1 condition_cat - condition_control 39.909           0.0196190 0.14146</span>
<span class="co">#&gt; 2     condition_cat - condition_dog  6.107           0.0006611 0.02572</span>
<span class="co">#&gt; 3 condition_control - condition_dog 52.148           0.0271902 0.16718</span>
<span class="co">#&gt;   non_centrality</span>
<span class="co">#&gt; 1        2.94171</span>
<span class="co">#&gt; 2        0.09725</span>
<span class="co">#&gt; 3        4.10867</span></code></pre>
<p>The result shows that you would have quite low power with 50
participants, both for the overall ANOVA (just below 50% power), as for
the follow up comparisons (approximately 40% power for the control vs
cat condition, just above 50% for the control vs dogs condition, and a
really low power (around 6%, just above the Type 1 error rate of 5%) for
the expected difference between cats and dogs. We can easily confirm the
expected power for these simple comparisons using the pwr package. For
our example, Cohen’s d (the standardized mean difference) is 2.2/6.4, or
d = 0.34375 for the difference between the control condition and cats,
2.6/6.4 of d = 0.40625 for the difference between the control condition
and dogs, and 0.4/6.4 or d = 0.0625 for the difference between cats and
dogs as pets.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/heliosdrm/pwr" class="external-link">pwr</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html" class="external-link">pwr.t.test</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">2.2</span><span class="op">/</span><span class="fl">6.4</span>,
           n <span class="op">=</span> <span class="fl">50</span>,
           sig.level <span class="op">=</span> <span class="fl">0.05</span>,
           type<span class="op">=</span><span class="st">"two.sample"</span>,
           alternative<span class="op">=</span><span class="st">"two.sided"</span><span class="op">)</span><span class="op">$</span><span class="va">power</span>
<span class="co">#&gt; [1] 0.3983064</span>

<span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html" class="external-link">pwr.t.test</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">2.6</span><span class="op">/</span><span class="fl">6.4</span>,
           n <span class="op">=</span> <span class="fl">50</span>,
           sig.level <span class="op">=</span> <span class="fl">0.05</span>,
           type<span class="op">=</span><span class="st">"two.sample"</span>,
           alternative<span class="op">=</span><span class="st">"two.sided"</span><span class="op">)</span><span class="op">$</span><span class="va">power</span>
<span class="co">#&gt; [1] 0.5205162</span>

<span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html" class="external-link">pwr.t.test</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.4</span><span class="op">/</span><span class="fl">6.4</span>,
           n <span class="op">=</span> <span class="fl">50</span>,
           sig.level <span class="op">=</span> <span class="fl">0.05</span>,
           type<span class="op">=</span><span class="st">"two.sample"</span>,
           alternative<span class="op">=</span><span class="st">"two.sided"</span><span class="op">)</span><span class="op">$</span><span class="va">power</span>
<span class="co">#&gt; [1] 0.06104044</span></code></pre></div>
<p>It is clear we would need to collect more participants in each group
to increase our power. We can plot a power curve across a range of
sample sizes to see how much we need to increase the sample size.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_power.html">plot_power</a></span><span class="op">(</span><span class="va">design_result</span>, min_n <span class="op">=</span> <span class="fl">10</span>, max_n <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></code></pre></div>
<p>We see 134 participants give us around 90% power for the ANOVA. But
we should also check the power for the comparison of the control
condition and the cat condition.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span> <span class="op">&lt;-</span> <span class="st">"3b"</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">134</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">26.2</span>, <span class="fl">26.6</span><span class="op">)</span>
<span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">6.4</span>
<span class="va">label_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"cat"</span>, <span class="st">"dog"</span><span class="op">)</span><span class="op">)</span>

<span class="va">design_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ANOVA_design.html">ANOVA_design</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span>,
                   n <span class="op">=</span> <span class="va">n</span>, 
                   mu <span class="op">=</span> <span class="va">mu</span>, 
                   sd <span class="op">=</span> <span class="va">sd</span>, 
                   label_list <span class="op">=</span> <span class="va">label_list</span>,
                   plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co">#do not print the plot (same as above)</span>

<span class="fu"><a href="../reference/ANOVA_exact.html">ANOVA_exact2</a></span><span class="op">(</span><span class="va">design_result</span>,
             emm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Power and Effect sizes for ANOVA tests</span>
<span class="co">#&gt;             power partial_eta_squared cohen_f non_centrality</span>
<span class="co">#&gt; condition 90.1767              0.0311  0.1793        12.8242</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for pairwise comparisons (t-tests)</span>
<span class="co">#&gt;                                   power effect_size</span>
<span class="co">#&gt; p_condition_control_condition_cat 80.05        0.34</span>
<span class="co">#&gt; p_condition_control_condition_dog 91.20        0.41</span>
<span class="co">#&gt; p_condition_cat_condition_dog      8.03        0.06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for estimated marginal means</span>
<span class="co">#&gt;                            contrast  power partial_eta_squared cohen_f</span>
<span class="co">#&gt; 1 condition_cat - condition_control 80.150           0.0194560 0.14086</span>
<span class="co">#&gt; 2     condition_cat - condition_dog  8.033           0.0006555 0.02561</span>
<span class="co">#&gt; 3 condition_control - condition_dog 91.266           0.0269660 0.16647</span>
<span class="co">#&gt;   non_centrality</span>
<span class="co">#&gt; 1         7.9170</span>
<span class="co">#&gt; 2         0.2617</span>
<span class="co">#&gt; 3        11.0576</span>

<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">180</span>
<span class="va">design_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ANOVA_design.html">ANOVA_design</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span>,
                   n <span class="op">=</span> <span class="va">n</span>, 
                   mu <span class="op">=</span> <span class="va">mu</span>, 
                   sd <span class="op">=</span> <span class="va">sd</span>, 
                   label_list <span class="op">=</span> <span class="va">label_list</span>,
                   plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co">#do not print the plot (same as above)</span>

<span class="fu"><a href="../reference/ANOVA_exact.html">ANOVA_exact2</a></span><span class="op">(</span><span class="va">design_result</span>,
             emm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Power and Effect sizes for ANOVA tests</span>
<span class="co">#&gt;             power partial_eta_squared cohen_f non_centrality</span>
<span class="co">#&gt; condition 96.7794              0.0311  0.1791        17.2266</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for pairwise comparisons (t-tests)</span>
<span class="co">#&gt;                                   power effect_size</span>
<span class="co">#&gt; p_condition_control_condition_cat 90.19        0.34</span>
<span class="co">#&gt; p_condition_control_condition_dog 97.02        0.41</span>
<span class="co">#&gt; p_condition_cat_condition_dog      9.09        0.06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for estimated marginal means</span>
<span class="co">#&gt;                            contrast power partial_eta_squared cohen_f</span>
<span class="co">#&gt; 1 condition_cat - condition_control 90.24           0.0194194 0.14073</span>
<span class="co">#&gt; 2     condition_cat - condition_dog  9.10           0.0006543 0.02559</span>
<span class="co">#&gt; 3 condition_control - condition_dog 97.04           0.0269157 0.16631</span>
<span class="co">#&gt;   non_centrality</span>
<span class="co">#&gt; 1        10.6348</span>
<span class="co">#&gt; 2         0.3516</span>
<span class="co">#&gt; 3        14.8535</span>

<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5380</span>
<span class="va">design_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ANOVA_design.html">ANOVA_design</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span>,
                   n <span class="op">=</span> <span class="va">n</span>, 
                   mu <span class="op">=</span> <span class="va">mu</span>, 
                   sd <span class="op">=</span> <span class="va">sd</span>, 
                   label_list <span class="op">=</span> <span class="va">label_list</span>,
                   plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co">#do not print the plot (same as above)</span>

<span class="fu"><a href="../reference/ANOVA_exact.html">ANOVA_exact2</a></span><span class="op">(</span><span class="va">design_result</span>,
             emm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Power and Effect sizes for ANOVA tests</span>
<span class="co">#&gt;           power partial_eta_squared cohen_f non_centrality</span>
<span class="co">#&gt; condition   100              0.0309  0.1786       514.8828</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for pairwise comparisons (t-tests)</span>
<span class="co">#&gt;                                   power effect_size</span>
<span class="co">#&gt; p_condition_control_condition_cat   100        0.34</span>
<span class="co">#&gt; p_condition_control_condition_dog   100        0.41</span>
<span class="co">#&gt; p_condition_cat_condition_dog        90        0.06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for estimated marginal means</span>
<span class="co">#&gt;                            contrast power partial_eta_squared cohen_f</span>
<span class="co">#&gt; 1 condition_cat - condition_control   100           0.0193172 0.14035</span>
<span class="co">#&gt; 2     condition_cat - condition_dog    90           0.0006507 0.02552</span>
<span class="co">#&gt; 3 condition_control - condition_dog   100           0.0267750 0.16587</span>
<span class="co">#&gt;   non_centrality</span>
<span class="co">#&gt; 1         317.86</span>
<span class="co">#&gt; 2          10.51</span>
<span class="co">#&gt; 3         443.96</span></code></pre></div>
<p>With 134 participants per condition, power for this simple comparison
is only 80%. If we want to aim for 90% power for follow up tests, we
need more participants. 180 participants provides good power for the
follow-up comparison between control and cats. But power for the
difference between cats and dogs is incredibly low. We would need 5380
participants to have 90% power for that comparison. This is possible if
you can easily collect data, but might make this specific question
impossible to reliably answer if data collection is costly. Realizing
you can not reliably study a question is an important aspect of a-priori
power analysis.</p>
</div>
<div class="section level2">
<h2 id="power-in-repeated-measures-anova">Power in Repeated Measures ANOVA<a class="anchor" aria-label="anchor" href="#power-in-repeated-measures-anova"></a>
</h2>
<p>In a repeated measures design multiple observations are collected
from the same participants. In the simplest case, where there are two
repeated observations, a repeated measures ANOVA equals a dependent or
paired <em>t</em>-test. Let’s explore the impact of this correlation on
the power of a repeated measures ANOVA.</p>
<div class="section level4">
<h4 id="two-within-conditions">Two within conditions<a class="anchor" aria-label="anchor" href="#two-within-conditions"></a>
</h4>
<p>To illustrate the effect of correlated observations, we start by
simulating data for a medium effect size for a dependent (or paired, or
within-subject) <em>t</em>-test. Let’s first look at G*power. If we want
to perform an a-priori power analysis, we are asked to fill in the
effect size <span class="math inline">\(d_z\)</span>. As Cohen (1988)
writes, “The Z subscript is used to emphasize the fact that our raw
score unit is no longer X or Y, but Z”, where Z are the difference
scores of X-Y.</p>
<p><img src="screenshots/gpower_9.png" width="600px"></p>
<p>Within designs can have greater power to detect differences than
between designs because the values are correlated, and a within design
requires less participants because each participant provides multiple
observations. One difference between an independent <em>t</em>-test and
a dependent <em>t</em>-test is that an independent <em>t</em>-test has
2(n-1) degrees of freedom, while a dependent <em>t</em>-test has (n-1)
degrees of freedom. The sample size needed in a two-group within-design
(NW) relative to the sample needed in two-group between-designs (NB),
assuming normal distributions, and ignoring the difference in degrees of
freedom between the two types of tests, is (from Maxwell &amp; Delaney,
2004, p. 561, formula 45):</p>
<p><span class="math inline">\(N_{W}=\frac{N_{B}(1-\rho)}{2}\)</span></p>
<p>The division by 2 in the equation is due to the fact that in a
two-condition within design every participant provides two data-points.
The extent to which this reduces the sample size compared to a
between-subject design depends on the correlation (<em>r</em>) between
the two dependent variables, as indicated by the 1-r part of the
equation. If the correlation is 0, a within-subject design needs half as
many participants as a between-subject design (e.g., 64 instead 128
participants), simply because every participants provides 2 datapoints.
The higher the correlation, the larger the relative benefit of within
designs, and whenever the correlation is negative (up to -1) the
relative benefit disappears.</p>
<p>Whereas in an independent <em>t</em>-test the two observations are
uncorrelated, in a within design the observations are correlated. This
has an effect on the standard deviation of the difference scores. In
turn, because the standardized effect size is the mean difference
divided by the standard deviation of the difference scores, the
correlation has an effect on the standardized mean difference in a
within design, Cohen’s <span class="math inline">\(d_z\)</span>. The
relation, as Cohen (1988, formula 2.3.7) explains, is:</p>
<p><span class="math inline">\(\sigma_{z}=\sigma\sqrt{2(1-\rho)}\)</span></p>
<p>Therefore, the relation between dz and d is <span class="math inline">\(\sqrt{2(1-\rho)}\)</span>. As Cohen (1988) writes:
“In other words, a given difference between population means for matched
(dependent) samples is standardized by a value which is <span class="math inline">\(\sqrt{2(1-\rho)}\)</span> as large as would be the
case were they independent. If we enter a correlation of 0.5 in the
formula, we get <span class="math inline">\(\sqrt{2(0.5)}=1\)</span>.
When the correlation is 0.5, d = <span class="math inline">\(d_z\)</span>. When there is a strong correlation
between dependent variables, for example r = 0.9, we get <span class="math inline">\(d=d_{z}\sqrt{2(1-0.9)}\)</span>, and a <span class="math inline">\(d_z\)</span> of 1 would be a d = 0.45. Reversely,
<span class="math inline">\(d_{z}=\frac{d}{\sqrt{2(1-r)}}\)</span>, so
with a r = 0.9, a d of 1 would be a <span class="math inline">\(d_z\)</span> = 2.24. Some consider this increase
in <span class="math inline">\(d_z\)</span> compared to d when
observations are strongly correlated an ‘inflation’ when estimating
effect sizes, but since the reduction in the standard deviation of the
difference scores due to the correlation makes it easier to distinguish
signal from noise in a hypothesis test, it leads to a clear power
benefit.</p>
<p>There is no equivalent <span class="math inline">\(f_z\)</span> for
Cohen’s f for a within subject ANOVA. For two groups, we can directly
compute Cohen’s f from Cohen’s d, as Cohen (1988) describes, because f =
<span class="math inline">\(\frac{1}{2}d\)</span>. For a d = 0.5, f =
0.25. In G*power we can run a 2 group within-subject power analysis for
ANOVA. We plan for 80% power, and reproduce the analysis above for the
dependent <em>t</em>-test. This works because the correlation is set to
0.5, when d = <span class="math inline">\(d_z\)</span>, and thus the
transformation of f=<span class="math inline">\(\frac{1}{2}d\)</span>
works.</p>
<p><img src="screenshots/gpower_1.png" width="600px"></p>
<p>If we change the correlation to 0.7 and keep all other settings the
same, the repeated measure a-priori power analysis yields a sample of
21. The correlation increases the power for the test.</p>
<p><img src="screenshots/gpower_11.png" width="600px"></p>
<p>To reproduce this analysis in G*power with a dependent
<em>t</em>-test we need to change <span class="math inline">\(d_z\)</span> following the formula above, <span class="math inline">\(d_{z}=\frac{0.5}{\sqrt{2(1-0.7)}}\)</span>, which
yields <span class="math inline">\(d_z\)</span> = 0.6454972. If we enter
this value in G*power for an a-priori power analysis, we get the exact
same results (as we should, since an repeated measures ANOVA with 2
groups equals a dependent <em>t</em>-test). This example illustrates
that the correlation between dependent variables always factors into a
power analysis, both for a dependent <em>t</em>-test, and for a repeated
measures ANOVA. Because a dependent <em>t</em>-test uses <span class="math inline">\(d_z\)</span> the correlation might be less
visible, but given the relation between d and <span class="math inline">\(d_z\)</span>, the correlation is always taken into
account and can greatly improve power for within designs compared to
between designs.</p>
<p><img src="screenshots/gpower_10.png" width="600px"></p>
<p>We can perform both these power analyses using simulations as well.
We set groups to 2 for the simulation, n = 34 (which should give 80.777
power, according to g*power), a correlation among repeated measures of
0.5, and an alpha of 0.05. In this case, we simulate data with means
-0.25 and 0.25, and set the sd to 1. This means we have a mean
difference of 0.5, and a Cohen’s d of 0.5/1 = 0.5. In the first example,
we set the correlation to 0.5, and the result should be 80.777% power,
and an effect size estimate of 0.5 for the simple effect. We also
calculate partial eta-squared for the ANOVA, which equals <span class="math inline">\(\frac{f^2}{f^2+1}\)</span>, or 0.05882353.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">34</span>
<span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span>
<span class="va">f</span> <span class="op">&lt;-</span> <span class="fl">0.25</span>
<span class="va">f2</span> <span class="op">&lt;-</span> <span class="va">f</span><span class="op">^</span><span class="fl">2</span>
<span class="va">ES</span> <span class="op">&lt;-</span> <span class="va">f2</span><span class="op">/</span><span class="op">(</span><span class="va">f2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>
<span class="va">ES</span>
<span class="co">#&gt; [1] 0.05882353</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mu_from_ES.html">mu_from_ES</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, ES <span class="op">=</span> <span class="va">ES</span><span class="op">)</span>
<span class="va">design</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">K</span>,<span class="st">"w"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="va">label_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"speed"</span> <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fast"</span>, <span class="st">"slow"</span><span class="op">)</span><span class="op">)</span>

<span class="va">design_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ANOVA_design.html">ANOVA_design</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span>,
                              n <span class="op">=</span> <span class="va">n</span>, 
                              mu <span class="op">=</span> <span class="va">mu</span>, 
                              sd <span class="op">=</span> <span class="va">sd</span>, 
                              r <span class="op">=</span> <span class="va">r</span>, 
                              label_list <span class="op">=</span> <span class="va">label_list</span>,
                              plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="more_anova_designs_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/ANOVA_exact.html">ANOVA_exact2</a></span><span class="op">(</span><span class="va">design_result</span>,
            emm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Power and Effect sizes for ANOVA tests</span>
<span class="co">#&gt;       power partial_eta_squared cohen_f non_centrality</span>
<span class="co">#&gt; speed 80.25              0.2026  0.5041         8.3852</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for pairwise comparisons (t-tests)</span>
<span class="co">#&gt;                         power effect_size</span>
<span class="co">#&gt; p_speed_fast_speed_slow 80.78         0.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for estimated marginal means</span>
<span class="co">#&gt;                  contrast power partial_eta_squared cohen_f non_centrality</span>
<span class="co">#&gt; 1 speed_fast - speed_slow 80.25              0.2026  0.5041          8.385</span></code></pre></div>
<p>The results of the exact simulation approach are indeed to 80.777%.
Note that the simulation calculates Cohen’s <span class="math inline">\(d_z\)</span> effect sizes for paired comparisons -
which here given the correlation of 0.5 is also 0.5 for a medium effect
size.</p>
<p>We should see a larger <span class="math inline">\(d_z\)</span> if we
increase the correlation, keeping the sample size the same, following
the example in Gpower above. We repeat the simulation, and the only
difference is a correlation between dependent variables of 0.7. This
should yield an effect size <span class="math inline">\(d_z\)</span> =
0.6454972.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">34</span>
<span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">0.7</span>
<span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span>
<span class="va">f</span> <span class="op">&lt;-</span> <span class="fl">0.25</span>
<span class="va">f2</span> <span class="op">&lt;-</span> <span class="va">f</span><span class="op">^</span><span class="fl">2</span>
<span class="va">ES</span> <span class="op">&lt;-</span> <span class="va">f2</span><span class="op">/</span><span class="op">(</span><span class="va">f2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>
<span class="va">ES</span>
<span class="co">#&gt; [1] 0.05882353</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mu_from_ES.html">mu_from_ES</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, ES <span class="op">=</span> <span class="va">ES</span><span class="op">)</span>
<span class="va">design</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">K</span>,<span class="st">"w"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="va">label_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"speed"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fast"</span>, <span class="st">"slow"</span><span class="op">)</span><span class="op">)</span>

<span class="va">design_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ANOVA_design.html">ANOVA_design</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span>,
                              n <span class="op">=</span> <span class="va">n</span>, 
                              mu <span class="op">=</span> <span class="va">mu</span>, 
                              sd <span class="op">=</span> <span class="va">sd</span>, 
                              r <span class="op">=</span> <span class="va">r</span>, 
                              label_list <span class="op">=</span> <span class="va">label_list</span>,
                              plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="more_anova_designs_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/ANOVA_exact.html">ANOVA_exact2</a></span><span class="op">(</span><span class="va">design_result</span>,
            emm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Power and Effect sizes for ANOVA tests</span>
<span class="co">#&gt;         power partial_eta_squared cohen_f non_centrality</span>
<span class="co">#&gt; speed 95.2298              0.2975  0.6508        13.9754</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for pairwise comparisons (t-tests)</span>
<span class="co">#&gt;                         power effect_size</span>
<span class="co">#&gt; p_speed_fast_speed_slow 95.47        0.65</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for estimated marginal means</span>
<span class="co">#&gt;                  contrast power partial_eta_squared cohen_f non_centrality</span>
<span class="co">#&gt; 1 speed_fast - speed_slow 95.23              0.2975  0.6508          13.98</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="power-in-repeated-measures-anova-with-more-than-2-groups">Power in Repeated Measures ANOVA with More than 2 Groups<a class="anchor" aria-label="anchor" href="#power-in-repeated-measures-anova-with-more-than-2-groups"></a>
</h4>
<p>We will examine a repeated measures experiment with 3
within-participant conditions, to illustrate how a repeated measures
ANOVA extends a dependent <em>t</em>-test. In the example for a
two-group within design we provided a specific formula for the sample
size benefit for two groups. The sample size needed in within-designs
(NW) with more than 2 conditions, relative to the sample needed in
between-designs (NB), assuming normal distributions and compound
symmetry, and ignoring the difference in degrees of freedom between the
two types of tests, is (from Maxwell &amp; Delaney, 2004, p. 562,
formula 47):</p>
<p><span class="math inline">\(N_{W}=\frac{N_{B}(1-\rho)}{a}\)</span></p>
<p>Where a is the number of within-subject levels.</p>
</div>
<div class="section level4">
<h4 id="the-relation-between-cohens-f-and-cohens-d">The relation between Cohen’s f and Cohen’s d<a class="anchor" aria-label="anchor" href="#the-relation-between-cohens-f-and-cohens-d"></a>
</h4>
<p>Whereas in the case of a repeated measures ANOVA with 2 groups we
could explain the principles of a power analysis by comparing our test
against a <em>t</em>-test and Cohen’s d, this becomes more difficult
when we have more than 2 groups. It is more useful to explain how to
directly calculate Cohen’s f, the effect size used in power analyses for
ANOVA. Cohen’s f is calculated following Cohen, 1988, formula 8.2.1 and
8.2.2:</p>
<p><span class="math inline">\(f =
\sqrt{\frac{\frac{\sum(\mu-\overline{\mu})^2)}N}\sigma}\)</span></p>
<p>Imagine we have a within-subject experiment with 3 conditions. We ask
people what they mood is when their alarm clock wakes them up, when they
wake up naturally on a week day, and when they wake up naturally on a
weekend day. Based on pilot data, we expect the means (on a 7 point
validated mood scale) are 3.8, 4.2, and 4.3. The standard deviation is
0.9, and the correlation between the dependent measurements is 0.7. We
can calculate Cohen’s f for the ANOVA, and Cohen’s dz for the
contrasts:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.8</span>, <span class="fl">4.2</span>, <span class="fl">4.3</span><span class="op">)</span>
<span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">0.9</span>
<span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">mu</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">sd</span> <span class="co">#Cohen, 1988, formula 8.2.1 and 8.2.2</span>
<span class="va">f</span>
<span class="co">#&gt; [1] 0.2400274</span>

<span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">0.7</span>
<span class="op">(</span><span class="fl">4.2</span><span class="op">-</span><span class="fl">3.8</span><span class="op">)</span><span class="op">/</span><span class="fl">0.9</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">r</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.5737753</span>
<span class="op">(</span><span class="fl">4.3</span><span class="op">-</span><span class="fl">3.8</span><span class="op">)</span><span class="op">/</span><span class="fl">0.9</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">r</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.7172191</span>
<span class="op">(</span><span class="fl">4.3</span><span class="op">-</span><span class="fl">4.2</span><span class="op">)</span><span class="op">/</span><span class="fl">0.9</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">r</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.1434438</span></code></pre></div>
<p>The relation between Cohen’s d or dz and Cohen’s f becomes more
difficult when there are multiple groups, because the relationship
depends on the pattern of the means. Cohen (1988) presents calculations
for three patterns, minimal variability (for example, for 5 means:
-0.25, 0, 0, 0, 0.25), medium variability (for example, for 5 means:
-0.25, -0.25, 0.25, 0.25, 0.25 or -0.25, -0.25, -0.25, 0.25, 0.25). For
these three patterns, formula’s are available that compute Cohen’s f
from Cohen’s d, where d is the effect size calculated for the difference
between the largest and smallest mean (if the largest mean is 0.25 and
the smallest mean is -0.25, 0.25 - -0.25 = 0.5, so d is 0.5 divided by
the standard deviation of 0.9). In our example, d would be (4.3-3.8)/0.9
= 0.5555556. If we divide this value by sqrt(2*(1-r)) we have dz =
0.5555556/0.7745967 = 0.7172191. If the means and standard deviation is
known, it is best to calculate Cohen’s f directly from these values.</p>
<p>We can perform power analyses for within designs using simulations.
We set groups to 3 for the simulation, n = 20, and the correlation
between dependent variables to 0.8. If the true effect size is f = 0.25,
and the alpha level is 0.05, the power is 96.9%.</p>
<p>In this case, we simulate data with means -0.3061862, 0.0000000, and
0.3061862, and set the sd to 1.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">20</span>
<span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">0.8</span>
<span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span>
<span class="va">f</span> <span class="op">&lt;-</span> <span class="fl">0.25</span>
<span class="va">f2</span> <span class="op">&lt;-</span> <span class="va">f</span><span class="op">^</span><span class="fl">2</span>
<span class="va">ES</span> <span class="op">&lt;-</span> <span class="va">f2</span><span class="op">/</span><span class="op">(</span><span class="va">f2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>
<span class="va">ES</span>
<span class="co">#&gt; [1] 0.05882353</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mu_from_ES.html">mu_from_ES</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, ES <span class="op">=</span> <span class="va">ES</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">mu</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">sd</span> <span class="co">#Cohen, 1988, formula 8.2.1 and 8.2.2</span>
<span class="co">#&gt; [1] 0.25</span>
<span class="va">design</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">K</span>,<span class="st">"w"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="va">label_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"speed"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fast"</span>, <span class="st">"medium"</span>, <span class="st">"slow"</span><span class="op">)</span><span class="op">)</span>

<span class="va">design_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ANOVA_design.html">ANOVA_design</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span>,
                              n <span class="op">=</span> <span class="va">n</span>, 
                              mu <span class="op">=</span> <span class="va">mu</span>, 
                              sd <span class="op">=</span> <span class="va">sd</span>, 
                              r <span class="op">=</span> <span class="va">r</span>, 
                              label_list <span class="op">=</span> <span class="va">label_list</span>,
                              plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="more_anova_designs_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">power_result</span> <span class="op">=</span> <span class="fu"><a href="../reference/ANOVA_power.html">ANOVA_power</a></span><span class="op">(</span><span class="va">design_result</span>,
                           nsims <span class="op">=</span> <span class="fl">250</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">power_result</span>,
        param <span class="op">=</span> <span class="st">"main_results"</span>,
        level <span class="op">=</span> <span class="fl">.98</span><span class="op">)</span>
<span class="co">#&gt;             power lower.ci upper.ci</span>
<span class="co">#&gt; anova_speed  96.8 93.81376 98.36976</span></code></pre></div>
<p>The results of the simulation are indeed very close to 96.9% (the
confidence intervals from the simulation include ). We can see this is
in line with the power estimate from Gpower:</p>
<p><img src="screenshots/gpower_12.png" width="600px"></p>
<p>We can even check the calculation of Cohen’s f SPSS style in GPower.
We take the GPower settings as illustrated above. We click the ‘Options’
button, and check the radio button next to ‘As in SPSS’. Click ok, and
you will notice that the ‘Corr among rep measures’ field has
disappeared. The correlation does not need to be entered separately, but
is incorporated in Cohen’s f. The value of Cohen’s f, which was 0.25,
has changed into 0.7024394. This is the SPSS equivalent. The value is
much larger. This value, and it’s corresponding partial eta-squared,
incorporate the correlation between observations.</p>
<p><img src="screenshots/gpower_14.png" width="600px"></p>
</div>
<div class="section level3">
<h3 id="x2-anova-within-between-design">2x2 ANOVA, within-between design<a class="anchor" aria-label="anchor" href="#x2-anova-within-between-design"></a>
</h3>
<p>We can simulate a two-way ANOVA with a specific alpha, sample size
and effect size, to achieve a specified statistical power. We will try
to reproduce the power analysis in G*power for an <em>F</em>-test,
ANOVA: Repeated measures, within-between interaction.</p>
<p><img src="screenshots/gpower_5.png" width="600px"></p>
<p>For the 2-way interaction, the result should be a power of 91.25% if
we have a total sample size of 46. Since we have 2 levels for the
between-participants factor, that means the number of groups 2 (and both
these groups collect 2 repeated measures).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="op">-</span><span class="fl">0.25</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">23</span>
<span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">design</span> <span class="op">=</span> <span class="st">"2w*2b"</span>
<span class="va">design_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ANOVA_design.html">ANOVA_design</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span>,
                              n <span class="op">=</span> <span class="va">n</span>, 
                              mu <span class="op">=</span> <span class="va">mu</span>, 
                              sd <span class="op">=</span> <span class="va">sd</span>, 
                              r <span class="op">=</span> <span class="va">r</span>,
                              plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="more_anova_designs_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/ANOVA_exact.html">ANOVA_exact2</a></span><span class="op">(</span><span class="va">design_result</span>,
             emm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Power and Effect sizes for ANOVA tests</span>
<span class="co">#&gt;       power partial_eta_squared cohen_f non_centrality</span>
<span class="co">#&gt; b    5.0000              0.0000   0.000         0.0000</span>
<span class="co">#&gt; a    5.0000              0.0000   0.000         0.0000</span>
<span class="co">#&gt; b:a 90.4745              0.2025   0.504        11.1746</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for pairwise comparisons (t-tests)</span>
<span class="co">#&gt;                       power effect_size</span>
<span class="co">#&gt; p_a_a1_b_b1_a_a1_b_b2 38.17         0.5</span>
<span class="co">#&gt; p_a_a1_b_b1_a_a2_b_b1 63.02         0.5</span>
<span class="co">#&gt; p_a_a1_b_b1_a_a2_b_b2  5.00         0.0</span>
<span class="co">#&gt; p_a_a1_b_b2_a_a2_b_b1  5.00         0.0</span>
<span class="co">#&gt; p_a_a1_b_b2_a_a2_b_b2 63.02        -0.5</span>
<span class="co">#&gt; p_a_a2_b_b1_a_a2_b_b2 38.17        -0.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for estimated marginal means</span>
<span class="co">#&gt;                contrast power partial_eta_squared   cohen_f non_centrality</span>
<span class="co">#&gt; 1 a_a1 b_b1 - a_a2 b_b1 63.76           1.127e-01 3.563e-01      5.587e+00</span>
<span class="co">#&gt; 2 a_a1 b_b1 - a_a1 b_b2 37.28           5.970e-02 2.520e-01      2.794e+00</span>
<span class="co">#&gt; 3 a_a1 b_b1 - a_a2 b_b2  5.00           5.299e-33 7.279e-17      2.331e-31</span>
<span class="co">#&gt; 4 a_a2 b_b1 - a_a1 b_b2  5.00           2.837e-34 1.684e-17      1.248e-32</span>
<span class="co">#&gt; 5 a_a2 b_b1 - a_a2 b_b2 37.28           5.970e-02 2.520e-01      2.794e+00</span>
<span class="co">#&gt; 6 a_a1 b_b2 - a_a2 b_b2 63.76           1.127e-01 3.563e-01      5.587e+00</span></code></pre></div>
<p>We can simulate the same Two-Way ANOVA increasing the correlation to
0.7. Power should be 98.98% for the two-way interaction.</p>
<p><img src="screenshots/gpower_6.png" width="600px"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="op">-</span><span class="fl">0.25</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">23</span>
<span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">0.7</span>
<span class="va">design</span> <span class="op">=</span> <span class="st">"2w*2b"</span>
<span class="va">design_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ANOVA_design.html">ANOVA_design</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span>,
                              n <span class="op">=</span> <span class="va">n</span>, 
                              mu <span class="op">=</span> <span class="va">mu</span>, 
                              sd <span class="op">=</span> <span class="va">sd</span>, 
                              r <span class="op">=</span> <span class="va">r</span>,
                              plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="more_anova_designs_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/ANOVA_exact.html">ANOVA_exact2</a></span><span class="op">(</span><span class="va">design_result</span>,
            emm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Power and Effect sizes for ANOVA tests</span>
<span class="co">#&gt;       power partial_eta_squared cohen_f non_centrality</span>
<span class="co">#&gt; b    5.0000              0.0000  0.0000         0.0000</span>
<span class="co">#&gt; a    5.0000              0.0000  0.0000         0.0000</span>
<span class="co">#&gt; b:a 98.8079              0.2974  0.6506        18.6243</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for pairwise comparisons (t-tests)</span>
<span class="co">#&gt;                       power effect_size</span>
<span class="co">#&gt; p_a_a1_b_b1_a_a1_b_b2 38.17        0.50</span>
<span class="co">#&gt; p_a_a1_b_b1_a_a2_b_b1 84.09        0.65</span>
<span class="co">#&gt; p_a_a1_b_b1_a_a2_b_b2  5.00        0.00</span>
<span class="co">#&gt; p_a_a1_b_b2_a_a2_b_b1  5.00        0.00</span>
<span class="co">#&gt; p_a_a1_b_b2_a_a2_b_b2 84.09       -0.65</span>
<span class="co">#&gt; p_a_a2_b_b1_a_a2_b_b2 38.17       -0.50</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for estimated marginal means</span>
<span class="co">#&gt;                contrast power partial_eta_squared   cohen_f non_centrality</span>
<span class="co">#&gt; 1 a_a1 b_b1 - a_a2 b_b1 84.72           1.747e-01 4.600e-01      9.312e+00</span>
<span class="co">#&gt; 2 a_a1 b_b1 - a_a1 b_b2 37.28           5.970e-02 2.520e-01      2.794e+00</span>
<span class="co">#&gt; 3 a_a1 b_b1 - a_a2 b_b2  5.00           5.481e-33 7.404e-17      2.412e-31</span>
<span class="co">#&gt; 4 a_a2 b_b1 - a_a1 b_b2  5.00           8.801e-33 9.381e-17      3.873e-31</span>
<span class="co">#&gt; 5 a_a2 b_b1 - a_a2 b_b2 37.28           5.970e-02 2.520e-01      2.794e+00</span>
<span class="co">#&gt; 6 a_a1 b_b2 - a_a2 b_b2 84.72           1.747e-01 4.600e-01      9.312e+00</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="two-way-anova-between-participants-design">Two-way ANOVA, between participants Design<a class="anchor" aria-label="anchor" href="#two-way-anova-between-participants-design"></a>
</h3>
<p>The effect size for interactions in factorial designs depends on the
pattern of means. Let’s assume the researcher plans to perform an
experiment where the voice of an artificial assistant sounds cheerful or
sad, and as a second factor the voice sound more robotic or more
human-like. Different patterns of results could be expected. Either the
cheerful voices are appreciated more than sad voices for both human and
robotic-sounding voice assistants. Or cheerful human voices are
preferred above sad human voices, but no difference is expected for
robotic voices, or the opposite effect is observed for robotic voices (a
‘Marvin-the-Depressed-Robot Effect’). In the first case, we will only
observe a main effect of voice, but in the other two scenarios there is
an interaction effect between human-likeness of the voice and the
emotional tone of the voice. We can start by simulating the power for a
cross-over interaction for a 2x2 between-participant design with 80
participants in each group (see the figure below for the expected
pattern of means).</p>
<div class="figure">
<img src="more_anova_designs_files/figure-html/mean-plot-1.png" alt="Vizualization for the expected means and confidence intervals for a crossover interaction." width="672"><p class="caption">
Vizualization for the expected means and confidence intervals for a
crossover interaction.
</p>
</div>
<p>Mathematically the interaction effect is computed as the cell mean
minus the sum of the grand mean, the marginal mean in each row minus the
grand mean, and the marginal mean in each column minus grand mean. For
example, for the cheerful human-like voice condition this is 1 - (0.5 +
(0.5) + (0.5)) = -0.5. Completing this for all four cells gives the
values -0.5, 0.5, 0.5, -0.5. Cohen’s f is then <span class="math inline">\(f = \frac { \sqrt { \frac { -0.5^2 + 0.5^2 + 0.5 +
-0.5^2 } { 4 } }}{ 2 } = 0.25\)</span>. Simulations show we have
99.3764726% power when we collected 80 participants per condition. A
cross-over (also called disordinal) interaction with two levels per
factor has exactly the same power as the initial two-group design. if we
halve the sample size per group for the cross-over interaction from 80
to 40. Power with 40 participants per condition is 88.1553371%. Main
effects in an ANOVA are based on the means for one factor averaged over
the other factors (e.g., the main effect of human-like versus robot-like
voice, irrespective of whether it is cheerful or sad). The interaction
effect, which can be contrast coded as 1, -1, -1, 1, is similarly a test
of whether the effects are non-additive based on the scores in each
cell, where the null-hypothesis of no additive effect can be rejected if
the deviation expected when effects in each cell would be purely
additive can be rejected. The key insight here is that not the sample
size per condition, but the total sample size over all other factor
determines the power for the main effects and the interaction.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># To save time compiling this vignette, we ran these simulations once, and stored them</span>
<span class="va">design_result_ordinal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ANOVA_design.html">ANOVA_design</a></span><span class="op">(</span>design <span class="op">=</span> <span class="st">"2b*2b"</span>, 
                                      n <span class="op">=</span> <span class="fl">160</span>, 
                                      mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, 
                                      sd <span class="op">=</span> <span class="fl">2</span>, 
                                      label_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cheerful"</span>, <span class="st">"sad"</span><span class="op">)</span>,
                                                     <span class="st">"voice"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"human"</span>, <span class="st">"robot"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># </span>
<span class="va">power_result_ordinal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ANOVA_power.html">ANOVA_power</a></span><span class="op">(</span><span class="va">design_result_ordinal</span>, 
                                    alpha_level <span class="op">=</span> <span class="fl">0.05</span>, 
                                    p_adjust <span class="op">=</span> <span class="st">"none"</span>, 
                                    seed <span class="op">=</span> <span class="fl">2019</span>, 
                                    nsims <span class="op">=</span> <span class="va">nsims</span><span class="op">)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">power_result_ordinal</span>, 
                     parm <span class="op">=</span> <span class="st">"main_results"</span>,
                     level <span class="op">=</span> <span class="fl">.98</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">power</th>
<th align="right">lower.ci</th>
<th align="right">upper.ci</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">anova_condition</td>
<td align="right">87.6</td>
<td align="right">82.93682</td>
<td align="right">91.12515</td>
</tr>
<tr class="even">
<td align="left">anova_voice</td>
<td align="right">90.4</td>
<td align="right">86.11342</td>
<td align="right">93.46381</td>
</tr>
<tr class="odd">
<td align="left">anova_condition:voice</td>
<td align="right">88.0</td>
<td align="right">83.38619</td>
<td align="right">91.46368</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">power_result_ordinal</span>, 
                     parm <span class="op">=</span> <span class="st">"pc_results"</span>,
                     level <span class="op">=</span> <span class="fl">.98</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="71%">
<col width="6%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">power</th>
<th align="right">lower.ci</th>
<th align="right">upper.ci</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">p_condition_cheerful_voice_human_condition_cheerful_voice_robot</td>
<td align="right">99.2</td>
<td align="right">97.130547</td>
<td align="right">99.780336</td>
</tr>
<tr class="even">
<td align="left">p_condition_cheerful_voice_human_condition_sad_voice_human</td>
<td align="right">99.2</td>
<td align="right">97.130547</td>
<td align="right">99.780336</td>
</tr>
<tr class="odd">
<td align="left">p_condition_cheerful_voice_human_condition_sad_voice_robot</td>
<td align="right">99.2</td>
<td align="right">97.130547</td>
<td align="right">99.780336</td>
</tr>
<tr class="even">
<td align="left">p_condition_cheerful_voice_robot_condition_sad_voice_human</td>
<td align="right">5.6</td>
<td align="right">3.364765</td>
<td align="right">9.179072</td>
</tr>
<tr class="odd">
<td align="left">p_condition_cheerful_voice_robot_condition_sad_voice_robot</td>
<td align="right">5.2</td>
<td align="right">3.063766</td>
<td align="right">8.692178</td>
</tr>
<tr class="even">
<td align="left">p_condition_sad_voice_human_condition_sad_voice_robot</td>
<td align="right">4.4</td>
<td align="right">2.474380</td>
<td align="right">7.705777</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#Analytic solution</span>
<span class="fu"><a href="../reference/power_twoway_between.html">power_twoway_between</a></span><span class="op">(</span><span class="va">design_result_ordinal</span><span class="op">)</span><span class="op">$</span><span class="va">power_A</span>
<span class="co">#&gt; [1] 88.44511</span>
<span class="fu"><a href="../reference/power_twoway_between.html">power_twoway_between</a></span><span class="op">(</span><span class="va">design_result_ordinal</span><span class="op">)</span><span class="op">$</span><span class="va">power_B</span>
<span class="co">#&gt; [1] 88.44511</span>
<span class="fu"><a href="../reference/power_twoway_between.html">power_twoway_between</a></span><span class="op">(</span><span class="va">design_result_ordinal</span><span class="op">)</span><span class="op">$</span><span class="va">power_AB</span>
<span class="co">#&gt; [1] 88.44511</span>
<span class="fu"><a href="../reference/power_twoway_between.html">power_twoway_between</a></span><span class="op">(</span><span class="va">design_result_ordinal</span><span class="op">)</span><span class="op">$</span><span class="va">Cohen_f_AB</span>
<span class="co">#&gt; [1] 0.125</span>
<span class="fu"><a href="../reference/power_twoway_between.html">power_twoway_between</a></span><span class="op">(</span><span class="va">design_result_ordinal</span><span class="op">)</span><span class="op">$</span><span class="va">eta_p_2_AB</span>
<span class="co">#&gt; [1] 0.01538462</span></code></pre></div>
<p>We can also examine the statistical power for a pattern of results
that indicated that there was no difference in interacting with a
cheerful of sad conversational agent with a robot voice. In this case,
we expect an ‘ordinal’ interaction (the means for the human-like voice
are never lower than the means for the robot-like voice, and thus there
is no cross-over effect). The pattern of means is now 1, 0, 0, 0, with
only a single mean that differs from the rest. These designs require
larger samples sizes to have the same power to detect the interaction,
compared to the two-group comparison. The reason for this is that the
effect size is only half as large, with Cohen’s <em>f</em> = 0.125
(compared to 0.25 in the cross-over interaction). By steadily increasing
the sample size in the simulation, we see that to achieve the same power
as for the two-group comparison, a total sample size of 635 is required,
almost four times as large as the sample size for the two-group
comparison (160).</p>
<p>The power in the 2x2 ordinal interaction where only one cell mean
differs from the other three cell means is identical to the power we
would have if the single mean was twice as far from the remaining means
(for a pattern of means of 2, 0, 0, 0). Similarly, if we would examine a
2x2x2 interaction where only one cell differs from the other means,
Cohen’s f would be 0.25 when the pattern of means is 4, 0, 0, 0, 0, 0,
0, 0 across the eight cells. The take-home message is that a ‘medium’
effect size translates into a much more extreme pattern of means in an
ordinal interaction than in a disordinal (crossover) interaction, or in
a 2x2x2 interaction compared to a 2x2 interaction. It might therefore be
more intuitive to perform a power analysis based on the expected pattern
of means, and compute Cohen’s f based on this pattern, than to specify
an effect size directly. The same effect size can represent very
different patterns of means depending on the type of interaction and the
number of factors.</p>
<div class="section level4">
<h4 id="x3-between-subject-anova">3x3 Between Subject ANOVA<a class="anchor" aria-label="anchor" href="#x3-between-subject-anova"></a>
</h4>
<p>If we extend the design with an extra level for each factor, we have
a 3x3 design (two factors, three levels each).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span> <span class="op">&lt;-</span> <span class="st">"3b*3b"</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">20</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span> 
<span class="co"># Enter means in the order that matches the labels below.</span>
<span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">5</span>
<span class="va">label_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Factor_A"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a1"</span>, <span class="st">"a2"</span>, <span class="st">"a3"</span><span class="op">)</span>, 
                <span class="st">"Factor_B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b1"</span>, <span class="st">"b2"</span>, <span class="st">"b3"</span><span class="op">)</span><span class="op">)</span> <span class="co">#</span>
<span class="co"># the label names should be in the order of the means specified above.</span>

<span class="va">design_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ANOVA_design.html">ANOVA_design</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span>,
                   n <span class="op">=</span> <span class="va">n</span>, 
                   mu <span class="op">=</span> <span class="va">mu</span>, 
                   sd <span class="op">=</span> <span class="va">sd</span>, 
                   label_list <span class="op">=</span> <span class="va">label_list</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">design_result</span><span class="op">)</span></code></pre></div>
<p><img src="more_anova_designs_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/ANOVA_exact.html">ANOVA_exact2</a></span><span class="op">(</span><span class="va">design_result</span>, 
            alpha_level <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
<span class="co">#&gt; Power and Effect sizes for ANOVA tests</span>
<span class="co">#&gt;                     power partial_eta_squared cohen_f non_centrality</span>
<span class="co">#&gt; Factor_A          43.4507              0.0244  0.1583         4.2843</span>
<span class="co">#&gt; Factor_B          43.4507              0.0244  0.1583         4.2843</span>
<span class="co">#&gt; Factor_A:Factor_B 62.5088              0.0477  0.2239         8.5686</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Power and Effect sizes for pairwise comparisons (t-tests)</span>
<span class="co">#&gt;                                                   power effect_size</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b1_Factor_A_a1_Factor_B_b2   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b1_Factor_A_a1_Factor_B_b3   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b1_Factor_A_a2_Factor_B_b1   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b1_Factor_A_a2_Factor_B_b2   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b1_Factor_A_a2_Factor_B_b3   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b1_Factor_A_a3_Factor_B_b1   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b1_Factor_A_a3_Factor_B_b2   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b1_Factor_A_a3_Factor_B_b3  86.9           1</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b2_Factor_A_a1_Factor_B_b3   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b2_Factor_A_a2_Factor_B_b1   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b2_Factor_A_a2_Factor_B_b2   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b2_Factor_A_a2_Factor_B_b3   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b2_Factor_A_a3_Factor_B_b1   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b2_Factor_A_a3_Factor_B_b2   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b2_Factor_A_a3_Factor_B_b3  86.9           1</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b3_Factor_A_a2_Factor_B_b1   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b3_Factor_A_a2_Factor_B_b2   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b3_Factor_A_a2_Factor_B_b3   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b3_Factor_A_a3_Factor_B_b1   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b3_Factor_A_a3_Factor_B_b2   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a1_Factor_B_b3_Factor_A_a3_Factor_B_b3  86.9           1</span>
<span class="co">#&gt; p_Factor_A_a2_Factor_B_b1_Factor_A_a2_Factor_B_b2   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a2_Factor_B_b1_Factor_A_a2_Factor_B_b3   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a2_Factor_B_b1_Factor_A_a3_Factor_B_b1   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a2_Factor_B_b1_Factor_A_a3_Factor_B_b2   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a2_Factor_B_b1_Factor_A_a3_Factor_B_b3  86.9           1</span>
<span class="co">#&gt; p_Factor_A_a2_Factor_B_b2_Factor_A_a2_Factor_B_b3   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a2_Factor_B_b2_Factor_A_a3_Factor_B_b1   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a2_Factor_B_b2_Factor_A_a3_Factor_B_b2   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a2_Factor_B_b2_Factor_A_a3_Factor_B_b3  86.9           1</span>
<span class="co">#&gt; p_Factor_A_a2_Factor_B_b3_Factor_A_a3_Factor_B_b1   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a2_Factor_B_b3_Factor_A_a3_Factor_B_b2   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a2_Factor_B_b3_Factor_A_a3_Factor_B_b3  86.9           1</span>
<span class="co">#&gt; p_Factor_A_a3_Factor_B_b1_Factor_A_a3_Factor_B_b2   5.0           0</span>
<span class="co">#&gt; p_Factor_A_a3_Factor_B_b1_Factor_A_a3_Factor_B_b3  86.9           1</span>
<span class="co">#&gt; p_Factor_A_a3_Factor_B_b2_Factor_A_a3_Factor_B_b3  86.9           1</span></code></pre></div>
<p>We can check these against the analytic solution.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">power_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_twoway_between.html">power_twoway_between</a></span><span class="op">(</span><span class="va">design_result</span><span class="op">)</span> <span class="co">#using default alpha level of .05</span>

<span class="va">power_res</span><span class="op">$</span><span class="va">power_A</span>
<span class="co">#&gt; [1] 44.86306</span>
<span class="va">power_res</span><span class="op">$</span><span class="va">power_B</span>
<span class="co">#&gt; [1] 44.86306</span>
<span class="va">power_res</span><span class="op">$</span><span class="va">power_AB</span>
<span class="co">#&gt; [1] 64.34127</span></code></pre></div>
<p>As we see, power is quite low with n = 20 per cell. Again, we can see
power across</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Not Run</span>
<span class="fu"><a href="../reference/plot_power.html">plot_power</a></span><span class="op">(</span><span class="va">design_result</span>, min_n <span class="op">=</span> <span class="fl">20</span>, max_n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="two-by-two-anova-within-design">Two by two ANOVA, within design<a class="anchor" aria-label="anchor" href="#two-by-two-anova-within-design"></a>
</h3>
<p>Potvin &amp; Schutz (2000) simulate a wide range of repeated measure
designs. The give an example of a 3x3 design, with the following
correlation matrix:</p>
<p><img src="screenshots/PS2000.gif" width="600px"></p>
<p>Variances were set to 1 (so all covariance matrices in their
simulations were identical). In this specific example, the white fields
are related to the correlation for the A main effect (these cells have
the same level for B, but different levels of A). The grey cells are
related to the main effect of B (the cells have the same level of A, but
different levels of B). Finally, the black cells are related to the AxB
interaction (they have different levels of A and B). The diagonal (all
1) relate to cells with the same levels of A and B.</p>
<p>Potvin &amp; Schulz (2000) examine power for 2x2 within factorial
designs and develop approximations of the error variance. For a design
with 2 within factors (A and B) these are:</p>
<p>For the main effect of A: <span class="math inline">\(\sigma _ { e }
^ { 2 } = \sigma ^ { 2 } ( 1 - \overline { \rho } _ { A } ) + \sigma ^ {
2 } ( q - 1 ) ( \overline { \rho } _ { B } - \overline { \rho } _ { AB }
)\)</span></p>
<p>For the main effect of B: <span class="math inline">\(\sigma _ { e }
^ { 2 } = \sigma ^ { 2 } ( 1 - \overline { \rho } _ { B } ) + \sigma ^ {
2 } ( p - 1 ) ( \overline { \rho } _ { A } - \overline { \rho } _ { A B
} )\)</span></p>
<p>For the interaction between A and B: <span class="math inline">\(\sigma _ { e } ^ { 2 } = \sigma ^ { 2 } ( 1 - \rho
_ { \max } ) - \sigma ^ { 2 } ( \overline { \rho } _ { \min } -
\overline { \rho } _ { AB } )\)</span></p>
<p>We first simulate a within subjects 2x2 ANOVA design.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span> 
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">20</span>
<span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">5</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
  <span class="fl">0.8</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span>,
       <span class="fl">0.4</span>, <span class="fl">0.5</span>,
            <span class="fl">0.8</span>
  <span class="op">)</span>

<span class="va">design</span> <span class="op">=</span> <span class="st">"2w*2w"</span>
<span class="va">label_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"a1"</span>, <span class="st">"a2"</span><span class="op">)</span>,
               <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b1"</span>, <span class="st">"b2"</span><span class="op">)</span><span class="op">)</span>
<span class="va">design_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ANOVA_design.html">ANOVA_design</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span>,
                              n <span class="op">=</span> <span class="va">n</span>, 
                              mu <span class="op">=</span> <span class="va">mu</span>, 
                              sd <span class="op">=</span> <span class="va">sd</span>, 
                              r <span class="op">=</span> <span class="va">r</span>, 
                              label_list <span class="op">=</span> <span class="va">label_list</span>,
                              plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="more_anova_designs_files/figure-html/unnamed-chunk-24-1.png" width="672"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">power_result_vig_4</span> <span class="op">=</span> <span class="fu"><a href="../reference/ANOVA_power.html">ANOVA_power</a></span><span class="op">(</span><span class="va">design_result</span>,
                                 nsims <span class="op">=</span> <span class="va">nsims</span><span class="op">)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">power_result_vig_4</span>, level <span class="op">=</span> <span class="fl">.98</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">power</th>
<th align="right">lower.ci</th>
<th align="right">upper.ci</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">anova_A</td>
<td align="right">30.4</td>
<td align="right">25.03025</td>
<td align="right">36.36297</td>
</tr>
<tr class="even">
<td align="left">anova_B</td>
<td align="right">62.4</td>
<td align="right">56.25067</td>
<td align="right">68.17402</td>
</tr>
<tr class="odd">
<td align="left">anova_A:B</td>
<td align="right">26.0</td>
<td align="right">20.95502</td>
<td align="right">31.77138</td>
</tr>
</tbody>
</table>
<p>We can use the exact simulation as well.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Not Run</span>
<span class="fu"><a href="../reference/ANOVA_exact.html">ANOVA_exact2</a></span><span class="op">(</span>design_result <span class="op">=</span> <span class="va">design_result</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aaron Caldwell, Daniel Lakens.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Power calculations for `emmeans` analyses â€¢ Superpower</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Power calculations for `emmeans` analyses">
<meta property="og:description" content="Superpower">
<meta property="og:image" content="/Sticker/Superpower2.PNG">
<meta property="og:image:alt" content="Superpower logo">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@exphysstudent">
<meta name="twitter:site" content="@exphysstudent">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Superpower</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ANCOVAs.html">Power Calculations for ANCOVA</a>
    </li>
    <li>
      <a href="../articles/compromise_power.html">Introduction to Justifying Alpha Levels</a>
    </li>
    <li>
      <a href="../articles/emmeans_power.html">Power calculations for `emmeans` analyses</a>
    </li>
    <li>
      <a href="../articles/intro_to_superpower.html">Introduction to Superpower</a>
    </li>
    <li>
      <a href="../articles/more_anova_designs.html">More ANOVA designs</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/arcaldwell49/Superpower/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Power calculations for <code>emmeans</code>
analyses</h1>
                        <h4 data-toc-skip class="author">Frederik
Aust</h4>
            
            <h4 data-toc-skip class="date">30 July, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/arcaldwell49/Superpower/blob/HEAD/vignettes/emmeans_power.Rmd" class="external-link"><code>vignettes/emmeans_power.Rmd</code></a></small>
      <div class="hidden name"><code>emmeans_power.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://aaroncaldwell.us/SuperpowerBook/" class="external-link">"Superpower"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/rvlenth/emmeans" class="external-link">"emmeans"</a></span><span class="op">)</span></code></pre></div>
<p>When conducting exact ANOVA power analyses with
<code>Superpower</code> it is possible to calculate the power for both
the omnibus <span class="math inline">\(F\)</span>-tests and planned
contrasts or post-hoc comparisons. It is possible to use this approach
to calculate power for standard contrasts, such as pairwise contrasts
between cells. Here I provide a brief overview of how the output of
<code><a href="../reference/ANOVA_exact.html">ANOVA_exact()</a></code> can be used to perform power analyses for
tailored planned contrasts and follow-up tests.</p>
<div class="section level2">
<h2 id="a-note-of-caution">A note of caution<a class="anchor" aria-label="anchor" href="#a-note-of-caution"></a>
</h2>
<p>All power analyses for <code>emmeans</code>-objects are based on the
<span class="math inline">\(F\)</span>- and <span class="math inline">\(t\)</span>-values from the analyses of the dataset
simulated by <code><a href="../reference/ANOVA_exact.html">ANOVA_exact()</a></code> assuming two-sided testing.
Thus, the <code><a href="../reference/emmeans_power.html">emmeans_power()</a></code> does not honor adjustments of the
testing procedure due to either one-sided testing (including two
one-sided tests) or corrections for multiple comparisons via the
<code>adjust</code> option in <code>emmeans</code>. As noted below, for
the Bonferroni-adjustment this limitation can be overcome by manually
adjusting <code>alpha_level</code>.</p>
</div>
<div class="section level2">
<h2 id="post-hoc-pairwise-comparisons">Post hoc pairwise comparisons<a class="anchor" aria-label="anchor" href="#post-hoc-pairwise-comparisons"></a>
</h2>
<p>First, we will set up a 2 <span class="math inline">\(\times\)</span>
3 repeated measures design. When calling <code><a href="../reference/ANOVA_exact.html">ANOVA_exact()</a></code>
pairwise comparisons of expected marginal means are added by setting
<code>emm = TRUE</code> and <code>contrast_type = "pairwise"</code>
(default).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Set up a within design with 2 factors, each with 2 and 3 levels</span>
<span class="va">design_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ANOVA_design.html">ANOVA_design</a></span><span class="op">(</span>
  design <span class="op">=</span> <span class="st">"2w*3w"</span>,
  n <span class="op">=</span> <span class="fl">40</span>,
  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
  sd <span class="op">=</span> <span class="fl">2</span>,
  r <span class="op">=</span> <span class="fl">0.8</span>, 
  label_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cheerful"</span>, <span class="st">"sad"</span><span class="op">)</span>,  
                    <span class="st">"voice"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"human"</span>, <span class="st">"robot"</span>, <span class="st">"cartoon"</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="emmeans_power_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exact_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ANOVA_exact.html">ANOVA_exact</a></span><span class="op">(</span>
  <span class="va">design_result</span>,
  alpha_level <span class="op">=</span> <span class="fl">0.05</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>,
  emm <span class="op">=</span> <span class="cn">TRUE</span>,
  contrast_type <span class="op">=</span> <span class="st">"pairwise"</span>
<span class="op">)</span></code></pre></div>
<p>The result contains the power calculations for both the omnibus <span class="math inline">\(F\)</span>-tests and pairwise post-hoc
comparisons.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exact_result</span><span class="op">$</span><span class="va">main_results</span></code></pre></div>
<pre><code><span class="co">#&gt;                    power partial_eta_squared   cohen_f non_centrality</span>
<span class="co">#&gt; condition       29.08380          0.05070994 0.2311251       2.083333</span>
<span class="co">#&gt; voice           50.12584          0.06212425 0.2573700       5.166667</span>
<span class="co">#&gt; condition:voice 41.62968          0.05070994 0.2311251       4.166667</span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">exact_result</span><span class="op">$</span><span class="va">emm_results</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">#&gt;                                                            contrast    power</span>
<span class="co">#&gt; 1    condition_cheerful voice_cartoon - condition_sad voice_cartoon 68.37160</span>
<span class="co">#&gt; 2 condition_cheerful voice_cartoon - condition_cheerful voice_human 16.41134</span>
<span class="co">#&gt; 3      condition_cheerful voice_cartoon - condition_sad voice_human 16.41134</span>
<span class="co">#&gt; 4 condition_cheerful voice_cartoon - condition_cheerful voice_robot 68.37160</span>
<span class="co">#&gt; 5      condition_cheerful voice_cartoon - condition_sad voice_robot 68.37160</span>
<span class="co">#&gt; 6      condition_sad voice_cartoon - condition_cheerful voice_human 30.99652</span>
<span class="co">#&gt;   partial_eta_squared   cohen_f non_centrality</span>
<span class="co">#&gt; 1          0.13812155 0.4003204           6.25</span>
<span class="co">#&gt; 2          0.02500000 0.1601282           1.00</span>
<span class="co">#&gt; 3          0.02500000 0.1601282           1.00</span>
<span class="co">#&gt; 4          0.13812155 0.4003204           6.25</span>
<span class="co">#&gt; 5          0.13812155 0.4003204           6.25</span>
<span class="co">#&gt; 6          0.05454545 0.2401922           2.25</span></code></pre>
<p>The output also contains the <code>emmeans</code>-object on which
these power calculations are based. By manipulating this object it is
possible to tailor the power analyses to the contrasts desired for the
planned study. That is, based on the dataset simulated with
<code><a href="../reference/ANOVA_exact.html">ANOVA_exact()</a></code> we can write out the analysis code for
<code>emmeans</code>-contrasts, just as we would if we were to analyze
the empirical data, and use the output to perform the corresponding
power analysis.</p>
</div>
<div class="section level2">
<h2 id="customized-emmeans-contrasts">Customized <code>emmeans</code> contrasts<a class="anchor" aria-label="anchor" href="#customized-emmeans-contrasts"></a>
</h2>
<p>The <code>emmeans</code> reference grid and contrasts are included in
the output of <code><a href="../reference/ANOVA_exact.html">ANOVA_exact()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">exact_result</span><span class="op">$</span><span class="va">emmeans</span><span class="op">$</span><span class="va">emmeans</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="26%">
<col width="19%">
<col width="9%">
<col width="13%">
<col width="4%">
<col width="13%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">condition</th>
<th align="left">voice</th>
<th align="right">emmean</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">lower.CL</th>
<th align="right">upper.CL</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">condition_cheerful</td>
<td align="left">voice_cartoon</td>
<td align="right">0.5</td>
<td align="right">0.3162278</td>
<td align="right">39</td>
<td align="right">-0.139631</td>
<td align="right">1.139631</td>
</tr>
<tr class="even">
<td align="left">condition_sad</td>
<td align="left">voice_cartoon</td>
<td align="right">0.0</td>
<td align="right">0.3162278</td>
<td align="right">39</td>
<td align="right">-0.639631</td>
<td align="right">0.639631</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful</td>
<td align="left">voice_human</td>
<td align="right">0.3</td>
<td align="right">0.3162278</td>
<td align="right">39</td>
<td align="right">-0.339631</td>
<td align="right">0.939631</td>
</tr>
<tr class="even">
<td align="left">condition_sad</td>
<td align="left">voice_human</td>
<td align="right">0.3</td>
<td align="right">0.3162278</td>
<td align="right">39</td>
<td align="right">-0.339631</td>
<td align="right">0.939631</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful</td>
<td align="left">voice_robot</td>
<td align="right">0.0</td>
<td align="right">0.3162278</td>
<td align="right">39</td>
<td align="right">-0.639631</td>
<td align="right">0.639631</td>
</tr>
<tr class="even">
<td align="left">condition_sad</td>
<td align="left">voice_robot</td>
<td align="right">0.0</td>
<td align="right">0.3162278</td>
<td align="right">39</td>
<td align="right">-0.639631</td>
<td align="right">0.639631</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">exact_result</span><span class="op">$</span><span class="va">emmeans</span><span class="op">$</span><span class="va">contrasts</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="66%">
<col width="9%">
<col width="4%">
<col width="3%">
<col width="8%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">contrast</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t.ratio</th>
<th align="right">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">condition_cheerful voice_cartoon - condition_sad
voice_cartoon</td>
<td align="right">0.5</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">2.5</td>
<td align="right">0.0167338</td>
</tr>
<tr class="even">
<td align="left">condition_cheerful voice_cartoon - condition_cheerful
voice_human</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">1.0</td>
<td align="right">0.3234749</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful voice_cartoon - condition_sad
voice_human</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">1.0</td>
<td align="right">0.3234749</td>
</tr>
<tr class="even">
<td align="left">condition_cheerful voice_cartoon - condition_cheerful
voice_robot</td>
<td align="right">0.5</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">2.5</td>
<td align="right">0.0167338</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful voice_cartoon - condition_sad
voice_robot</td>
<td align="right">0.5</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">2.5</td>
<td align="right">0.0167338</td>
</tr>
<tr class="even">
<td align="left">condition_sad voice_cartoon - condition_cheerful
voice_human</td>
<td align="right">-0.3</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">-1.5</td>
<td align="right">0.1416670</td>
</tr>
<tr class="odd">
<td align="left">condition_sad voice_cartoon - condition_sad
voice_human</td>
<td align="right">-0.3</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">-1.5</td>
<td align="right">0.1416670</td>
</tr>
<tr class="even">
<td align="left">condition_sad voice_cartoon - condition_cheerful
voice_robot</td>
<td align="right">0.0</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">0.0</td>
<td align="right">1.0000000</td>
</tr>
<tr class="odd">
<td align="left">condition_sad voice_cartoon - condition_sad
voice_robot</td>
<td align="right">0.0</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">0.0</td>
<td align="right">1.0000000</td>
</tr>
<tr class="even">
<td align="left">condition_cheerful voice_human - condition_sad
voice_human</td>
<td align="right">0.0</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">0.0</td>
<td align="right">1.0000000</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful voice_human - condition_cheerful
voice_robot</td>
<td align="right">0.3</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">1.5</td>
<td align="right">0.1416670</td>
</tr>
<tr class="even">
<td align="left">condition_cheerful voice_human - condition_sad
voice_robot</td>
<td align="right">0.3</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">1.5</td>
<td align="right">0.1416670</td>
</tr>
<tr class="odd">
<td align="left">condition_sad voice_human - condition_cheerful
voice_robot</td>
<td align="right">0.3</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">1.5</td>
<td align="right">0.1416670</td>
</tr>
<tr class="even">
<td align="left">condition_sad voice_human - condition_sad
voice_robot</td>
<td align="right">0.3</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">1.5</td>
<td align="right">0.1416670</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful voice_robot - condition_sad
voice_robot</td>
<td align="right">0.0</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">0.0</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<p>By using <code><a href="../reference/emmeans_power.html">emmeans_power()</a></code> on the contrasts, we can
reproduce the results of the previous power analysis for the pairwise
comparisons.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/emmeans_power.html">emmeans_power</a></span><span class="op">(</span><span class="va">exact_result</span><span class="op">$</span><span class="va">emmeans</span><span class="op">$</span><span class="va">contrasts</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">#&gt;                                                            contrast    power</span>
<span class="co">#&gt; 1    condition_cheerful voice_cartoon - condition_sad voice_cartoon 68.37160</span>
<span class="co">#&gt; 2 condition_cheerful voice_cartoon - condition_cheerful voice_human 16.41134</span>
<span class="co">#&gt; 3      condition_cheerful voice_cartoon - condition_sad voice_human 16.41134</span>
<span class="co">#&gt; 4 condition_cheerful voice_cartoon - condition_cheerful voice_robot 68.37160</span>
<span class="co">#&gt; 5      condition_cheerful voice_cartoon - condition_sad voice_robot 68.37160</span>
<span class="co">#&gt; 6      condition_sad voice_cartoon - condition_cheerful voice_human 30.99652</span>
<span class="co">#&gt;   partial_eta_squared   cohen_f non_centrality</span>
<span class="co">#&gt; 1          0.13812155 0.4003204           6.25</span>
<span class="co">#&gt; 2          0.02500000 0.1601282           1.00</span>
<span class="co">#&gt; 3          0.02500000 0.1601282           1.00</span>
<span class="co">#&gt; 4          0.13812155 0.4003204           6.25</span>
<span class="co">#&gt; 5          0.13812155 0.4003204           6.25</span>
<span class="co">#&gt; 6          0.05454545 0.2401922           2.25</span></code></pre>
<p>Now, we can manipulate the <code>emmeans</code> reference grid to
perform additional power analyses. In the following example, we
calculate the power for the contrasts between sad and cheerful condition
for each voice.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simple_condition_effects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span>
  <span class="va">exact_result</span><span class="op">$</span><span class="va">emmeans</span><span class="op">$</span><span class="va">emmeans</span>,
  specs <span class="op">=</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">voice</span>
<span class="op">)</span>

<span class="fu"><a href="../reference/emmeans_power.html">emmeans_power</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">simple_condition_effects</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">#&gt;                             contrast         voice   power partial_eta_squared</span>
<span class="co">#&gt; 1 condition_cheerful - condition_sad voice_cartoon 68.3716        1.381215e-01</span>
<span class="co">#&gt; 2 condition_cheerful - condition_sad   voice_human  5.0000        7.901251e-33</span>
<span class="co">#&gt; 3 condition_cheerful - condition_sad   voice_robot  5.0000        4.444454e-34</span>
<span class="co">#&gt;        cohen_f non_centrality</span>
<span class="co">#&gt; 1 4.003204e-01   6.250000e+00</span>
<span class="co">#&gt; 2 8.888898e-17   3.081488e-31</span>
<span class="co">#&gt; 3 2.108187e-17   1.733337e-32</span></code></pre>
<p>We may also calculate the power for testing all condition means
against an arbitrary constant.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/emmeans_power.html">emmeans_power</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/summary.emmGrid.html" class="external-link">test</a></span><span class="op">(</span><span class="va">simple_condition_effects</span>, null <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">#&gt;            condition         voice     power partial_eta_squared      cohen_f</span>
<span class="co">#&gt; 1 condition_cheerful voice_cartoon  5.000000        3.160500e-33 5.621833e-17</span>
<span class="co">#&gt; 2      condition_sad voice_cartoon 33.831141        6.024096e-02 2.531848e-01</span>
<span class="co">#&gt; 3 condition_cheerful   voice_human  9.462673        1.015228e-02 1.012739e-01</span>
<span class="co">#&gt; 4      condition_sad   voice_human  9.462673        1.015228e-02 1.012739e-01</span>
<span class="co">#&gt; 5 condition_cheerful   voice_robot 33.831141        6.024096e-02 2.531848e-01</span>
<span class="co">#&gt; 6      condition_sad   voice_robot 33.831141        6.024096e-02 2.531848e-01</span>
<span class="co">#&gt;   non_centrality</span>
<span class="co">#&gt; 1   1.232595e-31</span>
<span class="co">#&gt; 2   2.500000e+00</span>
<span class="co">#&gt; 3   4.000000e-01</span>
<span class="co">#&gt; 4   4.000000e-01</span>
<span class="co">#&gt; 5   2.500000e+00</span>
<span class="co">#&gt; 6   2.500000e+00</span></code></pre>
<p>Finally, we can calculate the power for custom contrasts between any
linear combination of conditions.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">custom_contrast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/contrast.html" class="external-link">contrast</a></span><span class="op">(</span>
  <span class="va">exact_result</span><span class="op">$</span><span class="va">emmeans</span><span class="op">$</span><span class="va">emmeans</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>robot_vs_sad_human <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="../reference/emmeans_power.html">emmeans_power</a></span><span class="op">(</span><span class="va">custom_contrast</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">#&gt;             contrast    power partial_eta_squared   cohen_f non_centrality</span>
<span class="co">#&gt; 1 robot_vs_sad_human 39.34971          0.07142857 0.2773501              3</span></code></pre>
<p>Although <code><a href="../reference/emmeans_power.html">emmeans_power()</a></code> currently ignores adjustments
for multiple comparisons, it is possible to calculate the power for
Bonferroni-corrected tests by adjusting <code>alpha_level</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n_contrasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">simple_condition_effects</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/emmeans_power.html">emmeans_power</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">simple_condition_effects</span><span class="op">)</span>,
  alpha_level <span class="op">=</span> <span class="fl">0.05</span> <span class="op">/</span> <span class="va">n_contrasts</span>
<span class="op">)</span></code></pre></div>
<pre><code><span class="co">#&gt;                             contrast         voice      power</span>
<span class="co">#&gt; 1 condition_cheerful - condition_sad voice_cartoon 40.1555499</span>
<span class="co">#&gt; 2 condition_cheerful - condition_sad   voice_human  0.8333333</span>
<span class="co">#&gt; 3 condition_cheerful - condition_sad   voice_robot  0.8333333</span>
<span class="co">#&gt;   partial_eta_squared      cohen_f non_centrality</span>
<span class="co">#&gt; 1        1.381215e-01 4.003204e-01   6.250000e+00</span>
<span class="co">#&gt; 2        7.901251e-33 8.888898e-17   3.081488e-31</span>
<span class="co">#&gt; 3        4.444454e-34 2.108187e-17   1.733337e-32</span></code></pre>
<p>Similarly, if we want to calculate power for a one-sided test, we can
doubling <code>alpha_level</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/emmeans_power.html">emmeans_power</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">simple_condition_effects</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
  alpha_level <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fl">0.05</span>
<span class="op">)</span></code></pre></div>
<pre><code><span class="co">#&gt;                             contrast         voice    power partial_eta_squared</span>
<span class="co">#&gt; 1 condition_cheerful - condition_sad voice_cartoon 79.14507           0.1381215</span>
<span class="co">#&gt;     cohen_f non_centrality</span>
<span class="co">#&gt; 1 0.4003204           6.25</span></code></pre>
<p>Note, that because power is calculated from the squared <span class="math inline">\(t\)</span>-value, power is only calculated
correctly if the alternative hypothesis is true in the simulated
dataset. That is, the difference of the condition means is consistent
with the tested directional hypothesis.</p>
<div class="section level3">
<h3 id="equivalence-and-non-superiority-inferiority-tests">Equivalence and non-superiority/-inferiority tests<a class="anchor" aria-label="anchor" href="#equivalence-and-non-superiority-inferiority-tests"></a>
</h3>
<p>Because <code>emmeans</code> can perform equivalence,
non-superiority, and -inferiority tests, <code><a href="../reference/emmeans_power.html">emmeans_power()</a></code>
can calculate the corresponding power for these tests.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/emmeans_power.html">emmeans_power</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">simple_condition_effects</span>, side <span class="op">=</span> <span class="st">"equivalence"</span>, delta <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
<span class="op">)</span></code></pre></div>
<pre><code><span class="co">#&gt;                             contrast       voice    power partial_eta_squared</span>
<span class="co">#&gt; 2 condition_cheerful - condition_sad voice_human 30.99652          0.05454545</span>
<span class="co">#&gt;     cohen_f non_centrality</span>
<span class="co">#&gt; 2 0.2401922           2.25</span></code></pre>
<p>Note, that because power is calculated from the squared <span class="math inline">\(t\)</span>-value, power is only calculated
correctly if the alternative hypothesis is true in the simulated
dataset. That is, the difference between the condition means is
consistent with the tested directional hypothesis (smaller than
<code>delta</code>).</p>
</div>
<div class="section level3">
<h3 id="joint-tests">Joint tests<a class="anchor" aria-label="anchor" href="#joint-tests"></a>
</h3>
<p>Another useful application of <code><a href="../reference/emmeans_power.html">emmeans_power()</a></code> is to
joint tests. Lets assume we plan to test the main effect of voice for
each of the two conditions separately using <code><a href="https://rdrr.io/pkg/emmeans/man/joint_tests.html" class="external-link">joint_tests()</a></code>.
We can then calculate the power for each Bonferroni-corrected <span class="math inline">\(F\)</span>-test as follows.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">voice_by_condition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/joint_tests.html" class="external-link">joint_tests</a></span><span class="op">(</span>
  <span class="va">exact_result</span><span class="op">$</span><span class="va">emmeans</span><span class="op">$</span><span class="va">emmeans</span>,
  by <span class="op">=</span> <span class="st">"condition"</span>
<span class="op">)</span>

<span class="fu"><a href="../reference/emmeans_power.html">emmeans_power</a></span><span class="op">(</span><span class="va">voice_by_condition</span>, alpha_level <span class="op">=</span> <span class="fl">0.05</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">#&gt;   model term          condition    power partial_eta_squared   cohen_f</span>
<span class="co">#&gt; 1      voice condition_cheerful 21.80102          0.07510613 0.2849651</span>
<span class="co">#&gt; 3      voice      condition_sad 10.39583          0.03703704 0.1961161</span>
<span class="co">#&gt;   non_centrality</span>
<span class="co">#&gt; 1          3.167</span>
<span class="co">#&gt; 3          1.500</span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aaron Caldwell, Daniel Lakens.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
